{# 
 # Template de gestion des genres de jeux
 #
 # Fonctionnalités :
 # - Affichage de la liste des genres
 # - Ajout d'un nouveau genre
 # - Modification d'un genre existant
 # - Suppression d'un genre
 # - Association d'un spécialiste à un genre
 #}
{% extends "base.html.twig" %}

{% block central %}
    <div class="col-sm-8">
        <section class="panel">
            {# En-tête du panneau #}
            <div class="chat-room-head">
                <h3><i class="fa fa-angle-right"></i> Gérer les genres</h3>
            </div>

            <div class="panel-body">
                {# Tableau des genres #}
                                <table class="table table-striped table-advance table-hover">
                    <thead>
                        <tr class="tableau-entete">
                            <th><i class="fa fa-bullhorn"></i> Identifiant</th>
                            <th><i class="fa fa-bookmark"></i> Libellé</th>
                            <th><i class="fa fa-bookmark"></i> Spécialiste</th>
                            <th><i class="fa fa-bookmark"></i> Nombre jeux</th>
                            <th>Actions</th>
                        </tr>
                    </thead>
                    <tbody>
                        {# Formulaire d'ajout d'un nouveau genre #}
                        <tr>
                            <form action="index.php?uc=gererGenres" method="post">
                                {# Identifiant du nouveau genre #}
                                <td>Nouveau</td>

                                {# Champ de saisie du libellé #}
                                <td>
                                    <input type="text" 
                                           id="txtLibGenre" 
                                           name="txtLibGenre" 
                                           size="24" 
                                           required
                                           minlength="4" 
                                           maxlength="24" 
                                           placeholder="Libellé" 
                                           title="De 4 à 24 caractères" />
                                </td>

                                {# Sélection du spécialiste #}
                                <td>
                                    {% set tbObjets, name, size, idSelect = tbMembres, 'lstMembre', 1, '' %}
                                    {{ include('liste.html.twig') }}
                                </td>

                                {# Nombre de jeux initial #}
                                <td>0</td>

                                {# Boutons d'action #}
                                <td>
                                    <button class="btn btn-primary btn-xs" 
                                            type="submit" 
                                            name="cmdAction"
                                            value="ajouterNouveauGenre" 
                                            title="Enregistrer nouveau genre">
                                        <i class="fa fa-save"></i>
                                    </button>
                                    <button class="btn btn-info btn-xs" 
                                            type="reset" 
                                            title="Effacer la saisie">
                                        <i class="fa fa-eraser"></i>
                                    </button>
                                </td>
                            </form>
                        </tr>
                        {# Liste des genres existants #}
                        {% for key, genre in tbGenres %}
                            <tr>
                                <form action="index.php?uc=gererGenres" method="post" style="display: contents;">
                                    {# ID du genre (caché) #}
                                    <input type="hidden" name="txtIdGenre" value="{{ genre.identifiant }}" />
                                    
                                    {# Affichage de l'identifiant #}
                                    <td>{{ genre.identifiant }}</td>

                                    {# Libellé du genre (modifiable ou non) #}
                                    <td>
                                        {% if genre.identifiant != idGenreModif %}
                                            {{ genre.libelle }}
                                        {% else %}
                                            <input type="text" 
                                                   id="txtLibGenre" 
                                                   name="txtLibGenre" 
                                                   size="24" 
                                                   required 
                                                   minlength="4" 
                                                   maxlength="24" 
                                                   value="{{ genre.libelle }}" />
{% endif %}
</td>
<td>
{% if genre.identifiant != idGenreModif %}
{{ genre.nomSpecialiste }}
{% else %}
{% set tbObjets, name, size, idSelect = tbMembres, 'lstMembre', 1, genre.idSpecialiste %}
{{ include('liste.html.twig') }}
{% endif %}
</td>
<td>
{{ genre.nbJeux }}
</td>
                                    <td>
                                        {% if genre.identifiant != idGenreModif %}
                                            {# Affichage de la notification si présente #}
                                            {% if notification != 'rien' and genre.identifiant == idGenreNotif %}
                                                <button class="btn btn-success btn-xs">
                                                    <i class="fa fa-check"></i> {{ notification }}
                                                </button>
                                            {% endif %}

                                            {# Boutons mode consultation #}
                                            <button class="btn btn-primary btn-xs" 
                                                    type="submit" 
                                                    name="cmdAction" 
                                                    value="demanderModifierGenre" 
                                                    title="Modifier">
                                                <i class="fa fa-pencil"></i>
                                            </button>
                                            <button class="btn btn-danger btn-xs" 
                                                    type="submit" 
                                                    name="cmdAction" 
                                                    value="supprimerGenre" 
                                                    title="Supprimer" 
                                                    onclick="return confirm('Voulez-vous vraiment supprimer ce genre ?');">
                                                <i class="fa fa-trash-o"></i>
                                            </button>
                                        {% else %}
                                            {# Boutons mode édition #}
                                            <button class="btn btn-primary btn-xs" 
                                                    type="submit" 
                                                    name="cmdAction" 
                                                    value="validerModifierGenre" 
                                                    title="Enregistrer">
                                                <i class="fa fa-save"></i>
                                            </button>
                                            <button class="btn btn-info btn-xs" 
                                                    type="reset" 
                                                    title="Effacer la saisie">
                                                <i class="fa fa-eraser"></i>
                                            </button>
                                            <button class="btn btn-warning btn-xs" 
                                                    type="submit" 
                                                    name="cmdAction" 
                                                    value="annulerModifierGenre" 
                                                    title="Annuler">
                                                <i class="fa fa-undo"></i>
                                            </button>
                                        {% endif %}
</td>
</form>
</tr>
{% endfor %}
</tbody>
</table>
</div><!-- fin div panel-body-->
</section><!-- fin section genres-->
</div><!--fin div col-sm-8-->
{% endblock %}